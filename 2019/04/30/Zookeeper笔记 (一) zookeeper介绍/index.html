
<!DOCTYPE html>
<html lang class="loading">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zookeeper笔记 (一) zookeeper介绍 - 朝阳的博客</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="Sunny,"> 
    <meta name="description" content="本文参考地址: 【Zookeeper 学习笔记】—zookeeper基本介绍

zookeeper是什么

zookeeper是一个高性能、开元的分布式应用协调服务，它提供了简单原始的功能，分布式应,"> 
    <meta name="author" content="Sunny___"> 
    <link rel="alternative" href="atom.xml" title="朝阳的博客" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
</head>
</html>
<body class="loading">
    <span id="config-title" style="display:none">朝阳的博客</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;" data-url="http://yoursite.com"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">Zookeeper笔记 (一) zookeeper介绍</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class="main">
        <h1 class="title">Zookeeper笔记 (一) zookeeper介绍</h1>
        <div class="stuff">
            <span>四月 30, 2019</span>
            
  <ul class="post-tags-list"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/znode/">znode</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/zookeeper/">zookeeper</a></li></ul>


        </div>
        <div class="content markdown">
            <p>本文参考地址: <a href="http://cmsblogs.com/?p=4099" target="_blank" rel="noopener">【Zookeeper 学习笔记】—zookeeper基本介绍</a></p>
<ul>
<li><h3 id="zookeeper是什么"><a href="#zookeeper是什么" class="headerlink" title="zookeeper是什么"></a>zookeeper是什么</h3></li>
</ul>
<p>zookeeper是一个高性能、开元的分布式应用协调服务，它提供了简单原始的功能，分布式应用可以基于它实现更高级的服务，比如实现同步(分布式锁)、配置管理、集群管理。它被设计为易于编程，使用文件系统目录树作为数据模型。服务端使用Java语言编写，并且提供了Java和C语言的客户端。</p>
<ul>
<li><h3 id="zookeeper数据模型"><a href="#zookeeper数据模型" class="headerlink" title="zookeeper数据模型"></a>zookeeper数据模型</h3></li>
</ul>
<p><img src="https://gitee.com/chenssy/blog-home/raw/master/image/series-images/zookeeper/zookeeper-1001.png" alt="image"></p>
<ul>
<li>树状结构中每个节点成为znode</li>
<li>每个znode都可以有数据(byte[]类型)，也可以有子节点</li>
<li>znode路径使用斜线分割，zk中没有相对路径的说法，所有路径都要写为绝对路径的方式</li>
<li>当zk中节点数据发生变化时，版本号递增</li>
<li><p>可以对znode中的数据进行读写操作</p>
</li>
<li><h3 id="zookeeper典型的应用场景"><a href="#zookeeper典型的应用场景" class="headerlink" title="zookeeper典型的应用场景"></a>zookeeper典型的应用场景</h3></li>
</ul>
<blockquote>
<p>数据发布/订阅</p>
</blockquote>
<p>数据发布/订阅即所谓的配置中心：发布者将数据发布到zk的一个或一系列节点上，订阅者进行数据订阅，可以及时得到数据的变化通知，如下图所示：</p>
<p><img src="https://gitee.com/chenssy/blog-home/raw/master/image/series-images/zookeeper/zookeeper-1002.png" alt="image"></p>
<p>应用A将数据发布到zkServer的某个znode上，应用B和C会现在zkServer上注册监听该节点的watcher(相当于Listener，基于RPC实现)，一旦该节点有数据变化，B和C的watcher就会得到通知，继而从zkServer获取最新的数据。</p>
<blockquote>
<p>负载均衡</p>
</blockquote>
<ul>
<li>zk实现负载均衡本质上市利用zk的配置管理功能，zk实现负载均衡的步骤为：</li>
<li>服务提供者把自己的域名及IP端口映射注册到zk中</li>
<li>服务消费者通过域名从zk中获取到对于的ip和端口，这里的ip和端口可能有多个，只获取其中一个</li>
<li>当服务提供者宕机时，对应的域名和ip就会减少一个映射</li>
</ul>
<blockquote>
<p>命名服务</p>
</blockquote>
<p>在分布式系统中，命名服务(name service)是很重要的应用场景，通过zk也可以实现类似于J2EE中JNDI的效果。分布式环境下命名服务更多的是资源定位，并不是真正的实体资源，其本质也是zk的集中配置和管理。</p>
<blockquote>
<p>分布式协调/通知</p>
</blockquote>
<p>通过zk的watcher和通知机制实现分布式锁和分布式事务</p>
<blockquote>
<p>集群管理</p>
</blockquote>
<p>获取当前集群中机器的数量、集群中机器的运行状态、集群中节点的上下线操作、集群节点的统一配置等。</p>
<p>此外还可以通过zk实现集群master节点的选举、分布式锁(排它锁、共享锁)、分布式队列等。</p>
<ul>
<li><h3 id="zookeeper中的一些基本概念"><a href="#zookeeper中的一些基本概念" class="headerlink" title="zookeeper中的一些基本概念"></a>zookeeper中的一些基本概念</h3></li>
</ul>
<blockquote>
<p>集群角色</p>
</blockquote>
<ul>
<li>Leader：为客户端提供读写服务</li>
<li>Follower：为客户端提供读服务，客户端到Follower的写请求会转交给Leader，Follower参与Leader选举</li>
<li>Observer：为客户端提供读服务，不参与Leader的选举，一般是为了增强zk集群的读请求并发能力</li>
</ul>
<blockquote>
<p>会话(Session)</p>
</blockquote>
<ul>
<li>session是客户端与zk服务端之间建立的长连接</li>
<li>zk在一个会话中进行心跳检测来感知客户端连接的存活</li>
<li>zk客户端在一个会话中接收来自服务端的watch事件通知</li>
<li>zk可以给会话设置超时时间</li>
</ul>
<blockquote>
<p>Znode</p>
</blockquote>
<ul>
<li>znode是zk树形结构中的数据节点，用于存储数据</li>
<li>znode分为持久节点和临时节点<ul>
<li>持久节点：一旦创建，除非主动调用删除操作， 否则一直存储在zk中</li>
<li>临时节点：与客户端会话绑定，一旦客户端时效，这个客户端创建的所以临时节点都会自动删除</li>
</ul>
</li>
<li>可以为持久节点或临时节点设置Sequential属性，该属性会自动在节点名称后面追加10位的整形数字</li>
</ul>
<blockquote>
<p>watcher</p>
</blockquote>
<ul>
<li>watcher监听在znode节点上</li>
<li>当节点的数据更新或子节点的状态发生变化都会使客户端的watcher得到通知</li>
</ul>
<blockquote>
<p>ACL(访问控制)</p>
</blockquote>
<p>类似于Linux下的权限控制</p>
<ul>
<li>CREATE：创建子节点的权限</li>
<li>READ：获取节点数据和子节点列表的权限</li>
<li>WRITE：更新节点数据的权限</li>
<li>DELETE：删除子节点的权限</li>
<li>ADMIN：设置节点ACL的权限</li>
</ul>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src>
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        <li title="0" data-url="http://link.hhtjim.com/163/5146554.mp3"></li>
                    
                        <li title="1" data-url="http://link.hhtjim.com/qq/001faIUs4M2zna.mp3"></li>
                    
                </ul>
            
        </div>
        

    </div>
    
        <div class="side">
            <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper是什么"><span class="toc-number">1.</span> <span class="toc-text">zookeeper是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper数据模型"><span class="toc-number">2.</span> <span class="toc-text">zookeeper数据模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper典型的应用场景"><span class="toc-number">3.</span> <span class="toc-text">zookeeper典型的应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper中的一些基本概念"><span class="toc-number">4.</span> <span class="toc-text">zookeeper中的一些基本概念</span></a></li></ol>
        </div>
    
</div>


    </div>
</div>
</body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>
